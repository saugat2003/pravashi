{% extends 'base.html' %}

{% block title %}Pradesh Setu - Home{% endblock %}

{% block nav_home_class %}text-primary font-bold{% endblock %}

{% block header %}
<!-- â”€â”€â”€ Top Section: User Identity & Safety Status â”€â”€â”€ -->
<header class="px-5 pt-5 pb-2">
    <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="w-11 h-11 rounded-full bg-primary/15 flex items-center justify-center">
                <span class="material-icons-round text-primary text-xl">person</span>
            </div>
            <div>
                <h1 class="text-lg font-extrabold leading-tight">
                    Namaste, <span class="text-primary">{{ user.first_name|default:user.username }}</span> ðŸ‘‹
                </h1>
                <div class="flex items-center gap-1">
                    <span class="material-icons-round text-primary text-xs">location_on</span>
                    <span class="text-[11px] font-medium opacity-60">{{ user.current_country|default:'Location not set' }}</span>
                </div>
            </div>
        </div>
        <a href="{% url 'main:safety_notifications' %}" class="relative">
            <div class="w-10 h-10 bg-white dark:bg-zinc-800 rounded-full flex items-center justify-center shadow-sm border border-zinc-100 dark:border-zinc-700">
                <span class="material-icons-round text-slate-500 dark:text-slate-300 text-[20px]">notifications</span>
            </div>
            {% if unread_count %}
            <div class="absolute top-0 right-0 w-2.5 h-2.5 bg-danger border-2 border-white dark:border-zinc-900 rounded-full"></div>
            {% endif %}
        </a>
    </div>

    <!-- Safety Status Card -->
    <div class="mt-4 p-3.5 rounded-2xl flex items-center gap-3
        {% if last_checkin %}
            bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800
        {% else %}
            bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800
        {% endif %}">
        <div class="w-10 h-10 rounded-full flex items-center justify-center
            {% if last_checkin %}bg-emerald-500{% else %}bg-red-500{% endif %}">
            <span class="material-icons-round text-white text-lg">
                {% if last_checkin %}verified_user{% else %}warning{% endif %}
            </span>
        </div>
        <div class="flex-1">
            <p class="text-[13px] font-bold {% if last_checkin %}text-emerald-700 dark:text-emerald-400{% else %}text-red-700 dark:text-red-400{% endif %}">
                {% if last_checkin %}
                    ðŸŸ¢ Status: Safe
                {% else %}
                    ðŸ”´ No Check-ins Yet
                {% endif %}
            </p>
            <p class="text-[11px] opacity-60">
                {% if last_checkin %}
                    Last: {{ last_checkin.checked_in_at|date:"M d, Y - g:i A" }}
                {% else %}
                    Tap below to check in
                {% endif %}
            </p>
        </div>
    </div>
</header>
{% endblock %}

{% block content %}

<!-- â”€â”€â”€ SOS Emergency Button â”€â”€â”€ -->
<div class="mt-4 px-1">
    <a href="{% url 'main:emergency_sos_activation' %}"
       class="block w-full py-5 bg-danger rounded-2xl text-center shadow-lg shadow-red-300/40 dark:shadow-red-900/40 active:scale-[0.97] transition-transform">
        <div class="flex items-center justify-center gap-2">
            <span class="material-icons-round text-white text-3xl animate-pulse">sos</span>
            <span class="text-white text-xl font-extrabold tracking-wide">SOS EMERGENCY</span>
        </div>
        <p class="text-white/80 text-[11px] font-medium mt-1">Tap for immediate help</p>
    </a>
</div>

<!-- â”€â”€â”€ Daily Check-In Button â”€â”€â”€ -->
<div class="mt-3 px-1">
    <a href="{% url 'main:daily_safety_check_in' %}"
       class="block w-full py-4 bg-[#10B981] hover:bg-[#059669] rounded-2xl text-center shadow-md shadow-emerald-200/50 dark:shadow-emerald-900/30 active:scale-[0.97] transition-all">
        <span class="text-white font-bold text-base">Check In Now</span>
    </a>
</div>

<!-- â”€â”€â”€ Main Action Buttons (4 Core Features) â”€â”€â”€ -->
<div class="mt-6 grid grid-cols-2 gap-3">

    <!-- 1. Check My Contract -->
    <a href="{% url 'main:contract_analysis_upload' %}"
       class="bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-700 active:scale-[0.97] transition-transform block">
        <div class="w-11 h-11 rounded-xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center mb-3">
            <span class="material-icons-round text-blue-500 text-xl">description</span>
        </div>
        <h3 class="text-sm font-bold leading-tight">Check My Contract</h3>
        <p class="text-[10px] opacity-50 mt-1 leading-snug">Upload & analyze your employment contract</p>
    </a>

    <!-- 2. Embassy Contacts -->
    <a href="{% url 'main:embassy_contact_directory' %}"
       class="bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-700 active:scale-[0.97] transition-transform block">
        <div class="w-11 h-11 rounded-xl bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center mb-3">
            <span class="material-icons-round text-purple-500 text-xl">account_balance</span>
        </div>
        <h3 class="text-sm font-bold leading-tight">Embassy Contacts</h3>
        <p class="text-[10px] opacity-50 mt-1 leading-snug">Find embassy & labor attachÃ© info</p>
    </a>

    <!-- 3. Community Nearby -->
    <a href="{% url 'main:community_locator' %}"
       class="bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-700 active:scale-[0.97] transition-transform block">
        <div class="w-11 h-11 rounded-xl bg-amber-50 dark:bg-amber-900/30 flex items-center justify-center mb-3">
            <span class="material-icons-round text-amber-500 text-xl">groups</span>
        </div>
        <h3 class="text-sm font-bold leading-tight">Community Nearby</h3>
        <p class="text-[10px] opacity-50 mt-1 leading-snug">Locate Nepali groups for help</p>
    </a>

    <!-- 4. Family Dashboard -->
    <a href="{% url 'main:family_safety_dashboard' %}"
       class="bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-zinc-100 dark:border-zinc-700 active:scale-[0.97] transition-transform block">
        <div class="w-11 h-11 rounded-xl bg-rose-50 dark:bg-rose-900/30 flex items-center justify-center mb-3">
            <span class="material-icons-round text-rose-500 text-xl">family_restroom</span>
        </div>
        <h3 class="text-sm font-bold leading-tight">Family Dashboard</h3>
        <p class="text-[10px] opacity-50 mt-1 leading-snug">View check-ins & manage alerts</p>
    </a>
</div>

{% endblock %}
